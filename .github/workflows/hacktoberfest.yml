name: Hacktoberfest PR Validation

on:
  pull_request:
    types: [opened, synchronize, reopened]

jobs:
  validate-hacktoberfest:
    runs-on: ubuntu-latest
    if: contains(github.event.pull_request.labels.*.name, 'hacktoberfest')
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v5
      
    - name: Validate PR for Hacktoberfest
      run: |
        echo "🎃 Validating Hacktoberfest PR..."
        
        # Check if PR has meaningful changes
        CHANGED_FILES=$(git diff --name-only HEAD~1 HEAD | wc -l)
        if [ "$CHANGED_FILES" -eq 0 ]; then
          echo "❌ No files changed in this PR"
          exit 1
        fi
        
        # Check PR description length
        PR_BODY_LENGTH=$(echo "${{ github.event.pull_request.body }}" | wc -c)
        if [ "$PR_BODY_LENGTH" -lt 20 ]; then
          echo "❌ PR description too short. Please provide a meaningful description."
          exit 1
        fi
        
        echo "✅ Hacktoberfest PR validation passed!"
        
    - name: Add Hacktoberfest comment
      uses: actions/github-script@v8
      with:
        github-token: ${{ secrets.GITHUB_TOKEN }}
        script: |
          github.rest.issues.createComment({
            issue_number: context.issue.number,
            owner: context.repo.owner,
            repo: context.repo.repo,
            body: '🎃 **Hacktoberfest 2025** 🎃\n\nThank you for your contribution to HordVoice! This PR has been validated for Hacktoberfest. \n\n✅ **Validation Status**: Passed\n\nYour contribution makes open source better! 🚀'
          });